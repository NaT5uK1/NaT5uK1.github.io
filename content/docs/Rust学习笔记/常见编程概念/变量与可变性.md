---
title: 变量与可变性
description:
toc: true
authors: []
date: 2022-02-13T14:58:53+08:00
lastmod: 2022-02-13T14:58:53+08:00
draft: false
weight: 1
---



## 变量与可变性

声明变量使用`let`关键字

```rust
let x = 1;
```

默认情况下，变量是不可变的（immutable）

```rust
let x = 1;
x = 2;	//cannot assign twice to immutable variable `x`
```

在声明变量时，可通过`mut`关键字使变量可变

```rust
let mut x = 1;
x = 2;	//value assigned to `x` is never read
```



## 变量与常量

声明常量使用`const`关键字

```rust
const MAX_NUMBER:u32 = 100_000;
```

变量与常量的区别如下：

|      | 声明关键字 |      可变性       | 类型标注 |             声明作用域             |         有效性         |       命名规范       |
| :--: | :--------: | :---------------: | :------: | :--------------------------------: | :--------------------: | :------------------: |
| 变量 |    let     | 使用`mut`变为可变 |  非必须  | ~~非全局作用域（正确性有待考证）~~ |                        |      snake_case      |
| 常量 |   const    |    永远不可变     |   必须   |     任何作用域，包含全局作用域     | 在声明作用域内一直有效 | SCREAMING_SNAKE_CASE |



## 变量的隐藏（Shadowing）

可以使用相同变量名声明新的变量，新的变量会将旧的变量隐藏

```rust
let x: i32 = 1;			//声明一个i32类型的不可变变量x，赋值为1
let x: u32 = 1;			//声明一个u32类型的不可变变量x，隐藏前一个x，赋值为1
let mut x = x + 1;		//再次声明一个可变的变量x，隐藏前一个x，等号右边表达式中的x即上一行声明的x,赋值为2
x = x * 2;				//将上一行的x进行表达式计算，值修改为4
```

+ 变量的隐藏可以是不同类型的
+ 变量的隐藏可以更改其可变性

> 变量的隐藏只发生在声明阶段，当不使用`let`关键字时，即为赋值语句，给不可变的变量赋值会报错

变量的隐藏经常发生在类型转换的场景下，无需为多个同意义的变量命名

```rust
let spaces = "    ";
let spaces = spaces.len();
```